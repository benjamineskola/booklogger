{% extends "base.html" %}
{% set page_title %}{{ book.display_title }} by {{ book.display_authors }}{% endset %}
{% block content %}
<div class="row">
{% include "books/multiline_entry_snippet.html" %}
</div>

<dl>
{% if book.default_authors != book.full_authors %}
<dt>Full Authors</dt><dd>
{% for author in book.full_authors %}
<a href="{{ url('author_details', args=[author.id]) }}">{{ author.attribution_for(book, initials=False) }}</a>
{%- if not loop.last %}, {% endif -%}
{%- endfor -%}
{% endif %}
<dt>Subtitle</dt><dd>{{ book.subtitle }}</dd>
{% if book.edition_title %}
<dt>Original Title</dt><dd>{{ book.title }}</br>
{% endif %}
<dt>First Published</dt><dd>{{ book.first_published }}</dd>
<dt>Edition Published</dt><dd>{{ book.edition_published }}</dd>

<dt>Publisher</dt><dd>{{ book.publisher }}</dd>
<dt>Format</dt><dd>{{ book.get_edition_format_display() }}</dd>
<dt>Edition</dt><dd>{{ book.edition_number }}</dd>
<dt>Pages</dt><dd>{{ book.page_count }}</dd>
<dt>Goodreads</dt><dd><a href="https://goodreads.com/book/show/{{ book.goodreads_id }}">{{ book.goodreads_id }}</a></dd>
{% if book.google_books_id %}
<dt>Google</dt><dd><a href="https://books.google.co.uk/books?id={{ book.google_books_id }}">{{ book.google_books_id }}</a></dd>
{% endif %}
{% if book.asin %}
<dt>Amazon</dt><dd><a href="https://amazon.co.uk/dp/{{ book.asin }}">{{ book.asin }}</a></dd>
{% endif %}
<dt>Publisher Link</dt><dd><a href="{{ book.publisher_url }}">{{ book.publisher }}</a></dd>
<dt>ISBN</dt><dd>{{ book.isbn }}</dd>
<dt>Language</dt><dd>{{ book.edition_language }}</dd>
<dt>Original language</dt><dd>{{ book.language }}</dd>
<dt>Owned</dt><dd>{{ book.owned }}</dd>
<dt>Acquired</dt><dd>{{ book.acquired_date }}</dd>
<dt>Sold/Donated</dt><dd>{{ book.alienated_date }}</dd>
<dt>Borrowed From</dt><dd>{{ book.borrowed_from }}</dd>
</dl>

<h3>Reading History</h3>
<ul class="list-unstyled">
{% for entry in book.log_entries.all() %}
  <li>{% include "logentries/date_snippet.html" %}<li>
{% else %}
<li>No reading history</li>
{% endfor %}
</ul>

{% if user.is_authenticated %}
{% if book.currently_reading %}
<form action="{{url('book_finish_reading', args=[book.id])}}" method="post">
  <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
  <input type="submit" name="Finish Reading" value="Finish Reading" />
</form>
{% else %}
<form action="{{url('book_start_reading', args=[book.id])}}" method="post">
  <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
  <input type="submit" name="Start Reading" value="Start Reading" />
</form>
{% endif %}

<a href="{{ url('admin:library_book_change', args=[book.id]) }}">edit</a>
{% else %}
<a href="{{ url('admin:login') }}">log in</a>
{% endif %}
{% endblock content %}
