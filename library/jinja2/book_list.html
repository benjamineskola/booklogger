{% from "macros/card.html" import book_list with context %}
{% extends "base.html" %}
{% block content %}
  {% if request.resolver_match.url_name not in ["books_read", "books_read_undated", "series_details", "tag_details", "books_reviewed", "books_unreviewed"] %}
    {% if not format %}
      <p class="ui top attached segment">
        Formats: <a href="{{ url("library:" + request.resolver_match.url_name) }}">all</a>
        {%- for n, f  in formats if n in counts and counts[n] > 0 -%}
          , <a href="{{ url("library:" + request.resolver_match.url_name, kwargs={"format": f.lower()}) }}">{{ f | lower }}</a> ({{ counts[n] }})
        {%- endfor -%}
        , <a href="{{ url("library:" + request.resolver_match.url_name, kwargs={"format": "physical"}) }}">physical</a> ({{ counts.get(1) | int + counts.get(2) | int }})
      </p>
    {% else %}
      <h2 class="ui header">{{ format }}</h2>
    {% endif %}
  {% endif %}

  {% if stats %}
    <p class="ui bottom attached segment">
      {{ stats["total"] }} items, {{ stats["owned"] }} owned, {{ stats["read"] }} read.
    </p>
  {% endif %}

  {{ book_list(page_obj) }}
{% endblock content %}
