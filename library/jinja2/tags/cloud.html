{% extends "base.html" %}
{% block content %}

{% for genre in ["all", "fiction", "non-fiction"] %}
  <h2>{{ genre.title() }}</h2>
  {% for sort_type, sorted_tags in tags.items() %}
    <strong>By {{ sort_type }}:</strong>
    {% for tag, count in sorted_tags[genre].items() %}
      {% if count %}
        {% if tag == "no other tags" %}
          <a class="badge badge-secondary" href="{{ url("library:tag_details", args=[genre + "!"]) }}">{{ tag }}: {{ count }}</a>
        {% else %}
          <a class="badge badge-{% if tag == genre %}info{% else%}secondary{% endif %}" href="{{ url("library:tag_details", args=[tag]) }}{% if tag != genre and genre != "all" %}?tags={{ genre }}{% endif %}">{{ tag }}: {{ count }}</a>
        {% endif %}
      {% endif %}
    {% endfor %}

    {% if genre == "all" and sorted_tags["untagged"] %}
      <a class="badge badge-secondary" href="{{ url("library:tag_details", args=["untagged"]) }}">untagged: {{ sorted_tags["untagged"] }}</a>
    {% endif %}
    <br>
  {% endfor %}
{% endfor %}
{% endblock content %}
